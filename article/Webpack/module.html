<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.41">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="./avator.png"><title>全面了解JS中的Module | op-chen's Blog</title><meta name="description" content="op-chen's Blog">
    <link rel="modulepreload" href="/Blog/assets/app.e87f5a68.js"><link rel="modulepreload" href="/Blog/assets/module.html.217ce180.js"><link rel="modulepreload" href="/Blog/assets/module.html.20138406.js"><link rel="prefetch" href="/Blog/assets/index.html.1dec0436.js"><link rel="prefetch" href="/Blog/assets/github-page.html.c0037a18.js"><link rel="prefetch" href="/Blog/assets/vuepress-mermaid.html.b1b77ce6.js"><link rel="prefetch" href="/Blog/assets/suspended-ball.html.1bbb1c35.js"><link rel="prefetch" href="/Blog/assets/handwrite.html.f180c9f0.js"><link rel="prefetch" href="/Blog/assets/usestate-source.html.c94475dd.js"><link rel="prefetch" href="/Blog/assets/vscode-plugin-start.html.df31da09.js"><link rel="prefetch" href="/Blog/assets/splitChunks.html.fc9eb3db.js"><link rel="prefetch" href="/Blog/assets/404.html.f166316b.js"><link rel="prefetch" href="/Blog/assets/index.html.0fc2e416.js"><link rel="prefetch" href="/Blog/assets/github-page.html.cdf5cdd4.js"><link rel="prefetch" href="/Blog/assets/vuepress-mermaid.html.6b0fc3ff.js"><link rel="prefetch" href="/Blog/assets/suspended-ball.html.ef7caef8.js"><link rel="prefetch" href="/Blog/assets/handwrite.html.ae8187a6.js"><link rel="prefetch" href="/Blog/assets/usestate-source.html.5e03400b.js"><link rel="prefetch" href="/Blog/assets/vscode-plugin-start.html.f2670890.js"><link rel="prefetch" href="/Blog/assets/splitChunks.html.a40b986e.js"><link rel="prefetch" href="/Blog/assets/404.html.a29fad9d.js"><link rel="prefetch" href="/Blog/assets/404.c54ff22d.js"><link rel="prefetch" href="/Blog/assets/Layout.41ec3b41.js">
    <link rel="stylesheet" href="/Blog/assets/style.8aab6938.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/Blog/" class=""><img class="logo" src="/Blog/./avator.png" alt="op-chen&#39;s Blog"><span class="site-name can-hide">op-chen&#39;s Blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon home-icon" viewbox="0 0 1024 1024" aria-labelledby="home"><title id="home" lang="en">home icon</title><g fill="currentColor"><path d="M779 1024h-184v-196.4c0-14.4-11.6-26-26-26h-93.2c-14.4 0-26 11.8-26 26V1024h-198.8c-54.8 0-99.4-44.6-99.4-99.4V600.2l-112.2-35-9-9c-26.6-26.6-26.6-69.6 0-96.2L470 20.4c12.8-12.8 29.8-20 48-20s35.2 7 48 20l439.6 439.8c12.8 12.8 20 30 19.8 48 0 18.2-7.2 35.2-20 48l-9 9-118.4 35.2v324.2c0.2 54.8-44.2 99.4-99 99.4z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon palette-icon" viewbox="0 0 1024 1024" aria-labelledby="palette" style="margin-left:1.5rem;"><title id="palette" lang="en">palette icon</title><g fill="currentColor"><path d="M408.57203 10.069411C209.785639 48.866755 49.596605 208.655816 10.399288 406.842249c-73.994935 373.974399 263.38197 652.755314 517.564569 613.358011 82.39436-12.799124 122.791594-109.192525 84.994182-183.387446-46.196838-90.793785 19.798645-196.786529 121.791662-196.786528h159.389089c71.595099 0 129.591129-59.195948 129.791115-130.59106C1022.929973 194.256802 736.149605-53.726222 408.57203 10.069411zM191.986857 640.026286c-35.397577 0-63.995619-28.598042-63.995619-63.995619s28.598042-63.995619 63.995619-63.995619 63.995619 28.598042 63.995619 63.995619-28.598042 63.995619-63.995619 63.995619z m63.995619-255.982476c-35.397577 0-63.995619-28.598042-63.995619-63.99562s28.598042-63.995619 63.995619-63.995619 63.995619 28.598042 63.995619 63.995619-28.598042 63.995619-63.995619 63.99562z m255.982476-127.991239c-35.397577 0-63.995619-28.598042-63.995619-63.995619s28.598042-63.995619 63.995619-63.995619 63.995619 28.598042 63.995619 63.995619-28.598042 63.995619-63.995619 63.995619z m255.982477 127.991239c-35.397577 0-63.995619-28.598042-63.995619-63.99562s28.598042-63.995619 63.995619-63.995619 63.995619 28.598042 63.995619 63.995619-28.598042 63.995619-63.995619 63.99562z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" aria-labelledby="github" style="margin-left:1.5rem;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M1023.560892 524.587752c0 114.331752-32.549236 217.148443-97.647709 308.450075-65.047295 91.301632-149.132822 154.455339-252.205404 189.512299-11.975662 2.303012-20.778286 0.716493-26.305515-4.759558a27.584966 27.584966 0 0 1-8.342021-20.471218V853.150798c0-44.166653-11.566238-76.511177-34.647536-96.982394a446.272549 446.272549 0 0 0 68.32269-12.282731c20.16415-5.476051 41.044792-14.329852 62.590748-26.612583a187.311643 187.311643 0 0 0 53.992837-45.446104c14.432209-18.014672 26.203159-41.914819 35.312851-71.751618 9.109692-29.8368 13.664538-64.074912 13.664538-102.765514 0-55.118754-17.554069-102.049021-52.61103-140.739623 16.376974-41.454216 14.636921-87.872703-5.373695-139.357815-12.436265-4.094244-30.399759-1.535341-53.941659 7.523172a355.17563 355.17563 0 0 0-61.311297 30.041513l-25.333132 16.376974a462.137743 462.137743 0 0 0-127.945112-17.707604 462.137743 462.137743 0 0 0-127.945111 17.758782 589.571074 589.571074 0 0 0-28.301459-18.424096c-11.77095-7.31846-30.34858-16.069906-55.681713-26.305515-25.281954-10.235609-44.422543-13.306292-57.31941-9.212048-19.498835 51.433935-21.085354 97.852421-4.606024 139.306637-35.108139 38.690602-52.713386 85.620869-52.713386 140.739623 0 38.690602 4.606024 72.826357 13.715716 102.458445 9.109692 29.58091 20.778286 53.481057 34.954605 71.700441a180.658498 180.658498 0 0 0 53.634591 45.753172c21.545957 12.282731 42.477777 21.18771 62.641926 26.612583 20.215328 5.527229 42.989557 9.621472 68.32269 12.333909-17.758781 16.376974-28.659705 39.867697-32.651593 70.369811a129.941055 129.941055 0 0 1-29.990334 10.235609 184.087426 184.087426 0 0 1-37.974109 3.428929c-14.688099 0-29.171485-4.913092-43.654872-14.688099-14.432209-9.826185-26.766117-24.053681-37.001726-42.682489a109.162769 109.162769 0 0 0-32.293346-35.517563c-13.101579-9.109692-24.104859-14.585743-33.009839-16.376974l-13.306292-2.047122c-9.314404 0-15.762838 1.023561-19.345301 3.070683-3.582463 2.047122-4.606024 4.606024-3.326572 7.83024a37.769397 37.769397 0 0 0 5.987831 9.570295 49.182101 49.182101 0 0 0 8.700267 8.188487l4.606024 3.377751c9.826185 4.606024 19.447657 13.255114 29.017952 25.998447 9.570294 12.743333 16.581686 24.360749 20.982998 34.80107l6.653146 15.71166c5.783119 17.298179 15.558126 31.320963 29.376197 42.017174 13.766894 10.747389 28.659705 17.554069 44.627255 20.471218 15.96755 2.968327 31.423319 4.606024 46.316131 4.810736 14.841633 0.204712 27.22672-0.562958 37.001726-2.405368l15.302235-2.712436c0 17.298179 0.102356 37.564685 0.358247 60.799517l0.307068 36.848192c0 8.188487-2.86597 15.046345-8.700268 20.471218-5.731941 5.527229-14.636921 7.113748-26.612583 4.810736-103.072582-35.056961-187.158109-98.261846-252.205404-189.512299C32.549236 741.736195 0 638.919504 0 524.587752c0-95.191163 22.876586-182.910331 68.629758-263.31104a516.028224 516.028224 0 0 1 186.288082-190.894106A491.309228 491.309228 0 0 1 511.780446 0.012795a491.309228 491.309228 0 0 1 256.913784 70.369811 516.028224 516.028224 0 0 1 186.236905 190.894106C1000.684306 341.626242 1023.560892 429.447767 1023.560892 524.587752z"></path></g></svg><!--]--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">JS相关 <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/article/Js/handwrite.html" class="sidebar-item" aria-label="在面试中手写的算法或者JS编程题"><!--[--><!--]--> 在面试中手写的算法或者JS编程题 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Css相关 <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/article/Css/suspended-ball.html" class="sidebar-item" aria-label="transition、animation实现动画方式"><!--[--><!--]--> transition、animation实现动画方式 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">搭建博客 <span class="right arrow"></span></p><!--[--><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/Blog/article/Blog/github-page.html" class="sidebar-item" aria-label="免费的搭建一个自己的博客"><!--[--><!--]--> 免费的搭建一个自己的博客 <!--[--><!--]--></a><!----></li><li><a href="/Blog/article/Blog/vuepress-mermaid.html" class="sidebar-item" aria-label="博客流程图(编写markdown-it插件)"><!--[--><!--]--> 博客流程图(编写markdown-it插件) <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">Webpack实践 <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/Blog/article/Webpack/splitChunks.html" class="sidebar-item" aria-label="代码分离优化首屏加载"><!--[--><!--]--> 代码分离优化首屏加载 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="全面了解JS中的Module"><!--[--><!--]--> 全面了解JS中的Module <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Blog/article/Webpack/module.html#为什么需要module" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么需要Module"><!--[--><!--]--> 为什么需要Module <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html#module是什么" class="router-link-active router-link-exact-active sidebar-item" aria-label="Module是什么"><!--[--><!--]--> Module是什么 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html#有哪几种常用的module" class="router-link-active router-link-exact-active sidebar-item" aria-label="有哪几种常用的Module"><!--[--><!--]--> 有哪几种常用的Module <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/Blog/article/Webpack/module.html#commonjs-cjs" class="router-link-active router-link-exact-active sidebar-item" aria-label="CommonJs(CJS)"><!--[--><!--]--> CommonJs(CJS) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html#amd" class="router-link-active router-link-exact-active sidebar-item" aria-label="AMD"><!--[--><!--]--> AMD <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html#umd" class="router-link-active router-link-exact-active sidebar-item" aria-label="UMD"><!--[--><!--]--> UMD <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/Blog/article/Webpack/module.html#ecmascript-esm" class="router-link-active router-link-exact-active sidebar-item" aria-label="ECMAScript(ESM)"><!--[--><!--]--> ECMAScript(ESM) <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="全面了解js中的module" tabindex="-1"><a class="header-anchor" href="#全面了解js中的module" aria-hidden="true">#</a> 全面了解JS中的Module</h1><h2 id="为什么需要module" tabindex="-1"><a class="header-anchor" href="#为什么需要module" aria-hidden="true">#</a> 为什么需要Module</h2><p>历史上，JavaScript 一直没有模块 Module 体系，无法将一个大程序拆分成互相依赖的小文件，再用简单的方法拼装起来。</p><div class="custom-container tip"><p class="custom-container-title">为什么要拆分?</p><p>如果将所有前端代码维护在一个文件中，那么基本没有可读性和可维护性可言。</p></div><h2 id="module是什么" tabindex="-1"><a class="header-anchor" href="#module是什么" aria-hidden="true">#</a> Module是什么</h2><p>那么很快地就可以讲出 Module 的定义：<br> 它的出现就是为了拆分一个大文件，那么每个Module就是一个小文件，可以相互依赖，最终结果是拼装成一个大文件。<br> 这样模块化的思想就很简单：把逻辑分块，各自封装，相互独立，每个块自行决定对外暴露什么，这个思想是所有 JavaScript Module 的基础。</p><p>我们也可以简单地写一个 Module 将代码定义封装在匿名闭包中。如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> Foo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &#39;bar&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="有哪几种常用的module" tabindex="-1"><a class="header-anchor" href="#有哪几种常用的module" aria-hidden="true">#</a> 有哪几种常用的Module</h2><div class="custom-container tip"><p class="custom-container-title">各种 Module 出现的原因</p><p>由于在 ECMAScript(ESM) 模块规范出现之前，原生浏览器并不支持 Module 的行为，而开发者们迫切的需要这样的行为。因此希望使用模块模式的库或代码库基于 JavaScript 的语法和词法特点“伪造”除了各种类似 Module 的行为。</p></div><p>下面的图表可以简单概括下各种常用 Module 实现的适用场景和特点：</p><table><thead><tr><th style="text-align:right;">Module</th><th>适用场景</th><th>特点</th></tr></thead><tbody><tr><td style="text-align:right;">CommonJs(CJS)</td><td>服务器，Node.js 使用了轻微修改版本的 CommonJs</td><td>以服务器端为目标环境，不考虑网络延迟，一次性将所有模块都加载到内存中</td></tr><tr><td style="text-align:right;">AMD</td><td>浏览器</td><td>以浏览器为目标环境,考虑网络延迟</td></tr><tr><td style="text-align:right;">通用模块定义 UMD</td><td>创建 (AMD,CJS) 都可以使用的模块代码</td><td>启动时检测使用哪个模块系统，返回需要的逻辑包装。</td></tr><tr><td style="text-align:right;">ECMAScript(ESM)</td><td>原生浏览器支持的模块加载方式</td><td>原生浏览器支持，同时吸收了AMD和CJS的一些优点，是集大成者</td></tr></tbody></table><h3 id="commonjs-cjs" tabindex="-1"><a class="header-anchor" href="#commonjs-cjs" aria-hidden="true">#</a> CommonJs(CJS)</h3><p>Node.js的模块系统，就是参照CommonJS规范实现的，CommonJS 对模块的加载时同步的。</p><blockquote><p>2009年，美国程序员Ryan Dahl创造了node.js项目，将javascript语言用于服务器端编程。<br> 这标志”Javascript模块化编程”正式诞生。前端的复杂程度有限，没有模块也是可以的，但是在服务器端，一定要有模块，与操作系统和其他应用程序互动，否则根本没法编程。</p></blockquote><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> moduleB <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;./moduleB&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">stuff</span><span class="token operator">:</span> moduleB<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>虽然 CommonJS 解决了模块化的问题，但是 CommonJS 对模块的加载时同步的。也就是说，如果模块加载需要的时间很长，将会阻塞页面的渲染，使整个应用陷入卡顿状态。然而这对服务器端而言并不是什么问题，因为所有的模块早就下载存放在本地磁盘，不需要经过网络传输便可同步加载完成，等待的时间只有磁盘读取的时间。但是，这对浏览器而言，是个大问题，模块都放在客户端，等待的时间取决于网络传输效率。因此，浏览器端的模块，只能采用异步加载。这就是AMD规范诞生的背景。</p><h3 id="amd" tabindex="-1"><a class="header-anchor" href="#amd" aria-hidden="true">#</a> AMD</h3><p>AMD的一般策略是让模块声明自己的依赖，而运行在浏览器中的模块系统会按需依赖，并在依赖加载完成后立即执行依赖他们的函数。<br> AMD实现的核心是用函数包装模块定义。这样可以防止声明全局变量，并允许加载器控制何时加载模块。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">// ID为 &#39;moduleA&#39;的模块定义。modulesA依赖moduleB</span>
<span class="token comment">// moduleB会异步加载</span>
<span class="token function">definde</span><span class="token punctuation">(</span><span class="token string">&#39;moduleA&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;moduleB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">moduleB</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">stuff</span><span class="token operator">:</span> moduleB<span class="token punctuation">.</span><span class="token function">doStuff</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="umd" tabindex="-1"><a class="header-anchor" href="#umd" aria-hidden="true">#</a> UMD</h3><p>为了统一 CommonJS 和 AMD 生态系统，通用模块定义规范应运而生。 UMD 可用于创建这个两个系统都可以使用的模块代码。<br> 本质上，UMD定义的模块会在启动时检查要使用哪个模块，然后适当配置，并把所有逻辑包装在有一个立即调用的函数式里。<br> 下面是一个依赖的UMD模块定义的示例:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// amd 注册为匿名模块</span>
    <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;moduleB&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> module <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">&amp;&amp;</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Node。不支持严格CommonJS</span>
    module<span class="token punctuation">.</span>exports <span class="token operator">===</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;moduleB&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 浏览器全局上下文</span>
    window<span class="token punctuation">.</span>returnExports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>moduleB<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 以魔种方式使用moduleB</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>UMD应用由构建工具自动生成。开发者只要专注于模块的内容，而不必关系这些样板代码。</p><h3 id="ecmascript-esm" tabindex="-1"><a class="header-anchor" href="#ecmascript-esm" aria-hidden="true">#</a> ECMAScript(ESM)</h3><p>随着 ECMAScript6 模块规范得到越来越广泛的支持，其他模块引入模式可能会走向没落。</p><p>常用写法：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./js/export.js&#39;</span>
<span class="token keyword">function</span> <span class="token function">foo2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> foo2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ECMAScript6 吸收了 AMD 和 CJS 的许多优秀特性，比如</p><ul><li>模块代码只在加载后执行</li><li>模块只能加载一次</li><li>模块是单例</li><li>模块可以定义公共接口，其他模块可以基于这个公共接口观察和交互</li><li>模块可以请求加载其他模块</li><li>支持循环依赖</li></ul><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 379712747@QQ.COM">chenlj</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/Blog/article/Webpack/splitChunks.html" class="" aria-label="代码分离优化首屏加载"><!--[--><!--]--> 代码分离优化首屏加载 <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/Blog/assets/app.e87f5a68.js" defer></script>
  </body>
</html>
